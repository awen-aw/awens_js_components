<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>拖拽</title>
    <style>
        div {
            width: 100px;
            height: 50px;
            background-color: pink;
            position: absolute;
        }
    </style>
</head>
<body>
    <div id="drag"></div>
    <script>
        window.onload = function () {
            var drag = document.getElementById('drag');
            /*
                1.点击某物体时，mousedown作用在这个对象上,
                2.按下的时候不放开，进行mousemove和mouseup，
                是在全局范围内进行移动，所以用document，
                3.如果用这个点击对象的话只能往右方或者下方移动，

            */
            drag.onmousedown = function (event) {
                //兼容IE浏览器
                var event = event || window.event; 
                //鼠标点击物体那一刻相对于物体左侧边框的距离 = 点击时鼠标的视口位置-物体左边框相对于浏览器左侧最左边的距离
                var diffX = event.clientX - drag.offsetLeft;
                var diffY = event.clientY - drag.offsetTop;
                if (typeof drag.setCapture !== 'undefined') {
                    drag.setCapture();
                }
                document.onmousemove = function (event) {
                    var event = event || window.event;
                    var moveX = event.clientX - diffX;
                    var moveY = event.clientY - diffY;
                    //边界处理
                    
                    if (moveX < 0) {
                        moveX = 0
                    } else if (moveX > window.innerWidth - drag.offsetWidth) {
                        moveX = window.innerWidth - drag.offsetWidth
                    }
                    if (moveY < 0) {
                        moveY = 0
                    } else if (moveY > window.innerHeight - drag.offsetHeight) {
                        moveY = window.innerHeight - drag.offsetHeight
                    }

                    drag.style.left = moveX + 'px';
                    drag.style.top = moveY + 'px'
                }
                document.onmouseup = function (event) {
                    this.onmousemove = null;
                    this.onmouseup = null;
                    //修复低版本ie bug  
                    if (typeof drag.releaseCapture != 'undefined') {
                        drag.releaseCapture();
                    }
                }
            }
        }
    </script>
</body>
</html>